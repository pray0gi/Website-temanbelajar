<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Algoritma & Lembar Kerja</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://css-proxy.vercel.app/api/fonts/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-btn.active { background-color: #0ea5e9; color: white; }
        .array-bar { transition: all 0.3s ease-in-out; }
        .feedback-correct { color: #4ade80; }
        .feedback-incorrect { color: #f87171; }
        .drag-item { cursor: grab; }
        .drop-zone.drag-over { background-color: #334155; border-style: dashed; }
    </style>
</head>
<body class="bg-slate-900 text-white">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-sky-400 to-cyan-300 text-transparent bg-clip-text">Simulasi & Lembar Kerja Algoritma</h1>
            <p class="text-slate-400 mt-2">Belajar, simulasi, dan uji pemahaman Anda di satu tempat.</p>
        </header>

        <!-- Tab Buttons -->
        <div class="flex border-b border-slate-700 mb-6">
            <button class="tab-btn flex-1 py-3 px-4 font-semibold text-slate-300 hover:bg-slate-700 transition-colors active" data-target="pencarian">Algoritma Pencarian</button>
            <button class="tab-btn flex-1 py-3 px-4 font-semibold text-slate-300 hover:bg-slate-700 transition-colors" data-target="pengurutan">Algoritma Pengurutan</button>
            <button class="tab-btn flex-1 py-3 px-4 font-semibold text-slate-300 hover:bg-slate-700 transition-colors" data-target="worksheet">Lembar Kerja Interaktif</button>
        </div>

        <!-- Konten Tab -->
        <main>
            <div id="pencarian" class="tab-content active">
                <div class="space-y-8">
                    <!-- Linear Search -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">1. Linear Search (Pencarian Linier)</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma paling dasar. Ia memeriksa setiap elemen dalam array satu per satu dari awal hingga akhir sampai elemen yang dicari ditemukan atau sampai seluruh array selesai diperiksa.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(1) - Elemen ditemukan di posisi pertama.</li>
                                    <li><strong>Average Case:</strong> O(n) - Elemen ditemukan di tengah.</li>
                                    <li><strong>Worst Case:</strong> O(n) - Elemen ditemukan di akhir atau tidak ada.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <input type="number" id="linear-search-value" class="bg-slate-700 p-2 rounded-md border border-slate-600 w-full sm:w-auto" placeholder="Cari angka...">
                                    <button id="linear-search-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Jalankan Otomatis</button>
                                    <button id="linear-search-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Langkah Berikutnya</button>
                                    <button id="linear-search-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Reset</button>
                                </div>
                                <div id="linear-search-container" class="flex justify-center items-end gap-1 h-32 bg-slate-950 p-2 rounded-md"></div>
                                <div id="linear-search-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Binary Search -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">2. Binary Search (Pencarian Biner)</h2>
                         <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma yang sangat efisien, namun **membutuhkan array yang sudah terurut**. Ia bekerja dengan membandingkan elemen target dengan elemen tengah array. Jika tidak sama, setengah bagian array yang tidak mungkin mengandung target akan diabaikan, dan pencarian dilanjutkan pada setengah sisanya. Proses ini diulangi hingga elemen ditemukan.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(1) - Elemen ditemukan di tengah pada percobaan pertama.</li>
                                    <li><strong>Average Case:</strong> O(log n) - Sangat cepat.</li>
                                    <li><strong>Worst Case:</strong> O(log n) - Sangat cepat.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <input type="number" id="binary-search-value" class="bg-slate-700 p-2 rounded-md border border-slate-600 w-full sm:w-auto" placeholder="Cari angka...">
                                    <button id="binary-search-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Jalankan Otomatis</button>
                                    <button id="binary-search-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Langkah Berikutnya</button>
                                    <button id="binary-search-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Reset</button>
                                </div>
                                <div id="binary-search-container" class="flex justify-center items-end gap-1 h-32 bg-slate-950 p-2 rounded-md"></div>
                                <div id="binary-search-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
            
            <div id="pengurutan" class="tab-content">
                 <div class="space-y-8">
                     <!-- Bubble Sort -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">1. Bubble Sort</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma ini berulang kali melewati daftar, membandingkan pasangan elemen yang berdekatan, dan menukarnya jika urutannya salah. Elemen terbesar akan "menggelembung" (bubble) ke posisi akhir pada setiap iterasi. Proses ini diulangi sampai tidak ada lagi pertukaran yang diperlukan.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(n) - Jika array sudah terurut.</li>
                                    <li><strong>Average Case:</strong> O(n²) - Cukup lambat.</li>
                                    <li><strong>Worst Case:</strong> O(n²) - Sangat lambat jika array terbalik.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <button id="bubble-sort-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Jalankan Otomatis</button>
                                    <button id="bubble-sort-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Langkah Berikutnya</button>
                                    <button id="bubble-sort-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Reset</button>
                                    <label for="speed-slider-bubble-sort" class="text-sm">Kecepatan:</label>
                                    <input type="range" id="speed-slider-bubble-sort" min="50" max="500" value="200" class="w-full sm:w-auto">
                                </div>
                                <div id="bubble-sort-container" class="flex justify-center items-end gap-1 h-64 bg-slate-950 p-2 rounded-md"></div>
                                <div id="bubble-sort-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Selection Sort -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">2. Selection Sort</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma ini membagi array menjadi dua bagian: bagian terurut dan bagian tidak terurut. Ia kemudian berulang kali mencari elemen terkecil dari bagian yang tidak terurut dan memindahkannya ke akhir bagian yang terurut. Proses ini diulangi hingga seluruh array terurut.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(n²)</li>
                                    <li><strong>Average Case:</strong> O(n²)</li>
                                    <li><strong>Worst Case:</strong> O(n²) - Performanya konsisten lambat.</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <button id="selection-sort-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Jalankan Otomatis</button>
                                    <button id="selection-sort-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Langkah Berikutnya</button>
                                    <button id="selection-sort-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Reset</button>
                                    <label for="speed-slider-selection-sort" class="text-sm">Kecepatan:</label>
                                    <input type="range" id="speed-slider-selection-sort" min="50" max="500" value="200" class="w-full sm:w-auto">
                                </div>
                                <div id="selection-sort-container" class="flex justify-center items-end gap-1 h-64 bg-slate-950 p-2 rounded-md"></div>
                                <div id="selection-sort-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="worksheet" class="tab-content">
                <div class="bg-slate-800 p-6 rounded-xl">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-cyan-300">Uji Pemahaman Anda</h2>
                        <div class="text-lg font-bold">Skor: <span id="worksheet-score" class="text-sky-400">0 / 3</span></div>
                    </div>

                    <div class="space-y-8">
                        <!-- Soal 1: Pilihan Ganda -->
                        <div class="bg-slate-900 p-4 rounded-lg" data-question="1">
                            <p class="font-semibold mb-3">1. Algoritma mana yang wajib menggunakan array yang sudah terurut?</p>
                            <div class="space-y-2">
                                <label class="flex items-center"><input type="radio" name="q1" value="linear" class="mr-2"> Linear Search</label>
                                <label class="flex items-center"><input type="radio" name="q1" value="binary" class="mr-2"> Binary Search</label>
                                <label class="flex items-center"><input type="radio" name="q1" value="bubble" class="mr-2"> Bubble Sort</label>
                            </div>
                            <div class="mt-4">
                                <button class="check-answer-btn bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg text-sm" data-question="1" data-correct="binary">Periksa Jawaban</button>
                                <span class="feedback-text ml-4 font-semibold"></span>
                            </div>
                        </div>

                        <!-- Soal 2: Urutkan Langkah (Drag & Drop) -->
                        <div class="bg-slate-900 p-4 rounded-lg" data-question="2">
                            <p class="font-semibold mb-3">2. Urutkan langkah-langkah dasar dari algoritma Selection Sort berikut ini:</p>
                            <div id="drop-zone-selection-sort" class="drop-zone border-2 border-slate-700 rounded-lg p-4 min-h-[200px] space-y-2">
                                <!-- Drop items here -->
                            </div>
                            <p class="text-xs text-slate-400 mt-2 mb-4">Seret langkah-langkah di bawah ini ke dalam kotak di atas.</p>
                            <div id="drag-items-container" class="flex flex-wrap gap-2">
                                <div class="drag-item bg-slate-700 p-2 rounded-md" draggable="true" data-step="3">Tukar elemen terkecil dengan elemen pertama di bagian yang belum terurut.</div>
                                <div class="drag-item bg-slate-700 p-2 rounded-md" draggable="true" data-step="1">Anggap elemen pertama sebagai yang terkecil.</div>
                                <div class="drag-item bg-slate-700 p-2 rounded-md" draggable="true" data-step="4">Ulangi proses untuk sisa array yang belum terurut.</div>
                                <div class="drag-item bg-slate-700 p-2 rounded-md" draggable="true" data-step="2">Bandingkan dengan sisa elemen untuk menemukan yang benar-benar terkecil.</div>
                            </div>
                            <div class="mt-4">
                                <button class="check-answer-btn bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg text-sm" data-question="2">Periksa Urutan</button>
                                <span class="feedback-text ml-4 font-semibold"></span>
                            </div>
                        </div>

                        <!-- Soal 3: Lengkapi Kode -->
                        <div class="bg-slate-900 p-4 rounded-lg" data-question="3">
                            <p class="font-semibold mb-3">3. Lengkapi potongan kode Bubble Sort di bawah ini. Apa kata kunci yang tepat untuk menukar dua nilai?</p>
                            <pre class="bg-slate-950 p-4 rounded-md text-sm"><code>
if (arr[j] > arr[j + 1]) {
  // Kata kunci untuk menukar nilai
  [arr[j], arr[j + 1]] = <input type="text" id="q3-input" class="bg-slate-700 border border-slate-600 rounded w-48 mx-2 px-1 text-center" placeholder="Lengkapi di sini...">;
}
                            </code></pre>
                            <div class="mt-4">
                                <button class="check-answer-btn bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg text-sm" data-question="3" data-correct="[arr[j+1],arr[j]]">Periksa Jawaban</button>
                                <span class="feedback-text ml-4 font-semibold"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            tabContents.forEach(content => content.classList.remove('active'));
            document.getElementById(button.dataset.target).classList.add('active');
        });
    });

    const createRandomArray = (size, maxVal, sorted = false) => {
        const arr = Array.from({ length: size }, () => Math.floor(Math.random() * maxVal) + 1);
        if (sorted) arr.sort((a, b) => a - b);
        return arr;
    };

    const renderArray = (container, arr, highlights = {}) => {
        container.innerHTML = arr.map((value, index) => {
            let bgColor = 'bg-slate-600';
            if (highlights.found === index) bgColor = 'bg-green-500';
            else if (highlights.comparing?.includes(index)) bgColor = 'bg-yellow-500';
            else if (highlights.pivot === index) bgColor = 'bg-purple-500';
            else if (highlights.sorted?.includes(index)) bgColor = 'bg-sky-500';
            const height = container.id.includes('sort') ? `${(value / 100) * 90 + 10}%` : '50%';
            return `<div class="array-bar flex-1 ${bgColor} text-center font-semibold pt-1 rounded-t-md" style="height: ${height};">${value}</div>`;
        }).join('');
    };

    function setupSimulator(config) {
        const { id, generatorFn, createArrayFn, getParamsFn } = config;
        const container = document.getElementById(`${id}-container`);
        const log = document.getElementById(`${id}-log`);
        const playBtn = document.getElementById(`${id}-play`);
        const stepBtn = document.getElementById(`${id}-step`);
        const resetBtn = document.getElementById(`${id}-reset`);
        const speedSlider = document.getElementById(`speed-slider-${id}`);

        let array = [];
        let generator = null;
        let isPlaying = false;
        let simSpeed = speedSlider ? parseInt(speedSlider.value) : 200;

        const setControlsDisabled = (disabled, keepPlayDisabled = false) => {
            if (playBtn) playBtn.disabled = keepPlayDisabled || disabled;
            if (stepBtn) stepBtn.disabled = disabled;
        };

        const reset = () => {
            isPlaying = false;
            array = createArrayFn();
            if (!getParamsFn) {
                generator = generatorFn(array.slice());
            } else {
                 generator = null;
            }
            renderArray(container, array);
            log.textContent = "Siap untuk memulai.";
            setControlsDisabled(false);
        };
        
        const step = () => {
            if (getParamsFn && (!generator || !isPlaying)) {
                generator = generatorFn(array.slice(), getParamsFn());
                isPlaying = true;
            }
            if (!generator) return;

            const result = generator.next();
            if (result.value) {
                const { arr, highlights, message } = result.value;
                if(arr) array = arr;
                renderArray(container, array, highlights);
                log.textContent = message;
            }
            if (result.done) {
                isPlaying = false;
                setControlsDisabled(true);
            } else {
                setControlsDisabled(true, true);
                stepBtn.disabled = false;
            }
        };

        const play = async () => {
            if (isPlaying) return;
            if (getParamsFn) {
                generator = generatorFn(array.slice(), getParamsFn());
            }
            if (!generator) return;

            isPlaying = true;
            setControlsDisabled(true);

            let result = {};
            while (!result.done) {
                result = generator.next();
                if (result.value) {
                    const { arr, highlights, message } = result.value;
                    if(arr) array = arr;
                    renderArray(container, array, highlights);
                    log.textContent = message;
                }
                if (result.done) break;
                await new Promise(resolve => setTimeout(resolve, simSpeed));
            }
            isPlaying = false;
        };

        if (playBtn) playBtn.addEventListener('click', play);
        if (stepBtn) stepBtn.addEventListener('click', step);
        resetBtn.addEventListener('click', reset);
        if (speedSlider) {
            speedSlider.addEventListener('input', (e) => {
                simSpeed = 600 - parseInt(e.target.value);
            });
        }
        
        reset();
    }

    function* linearSearchGenerator(arr, { value }) {
        if (isNaN(value)) {
            yield { message: "Masukkan angka yang valid!" }; return;
        }
        for (let i = 0; i < arr.length; i++) {
            yield { arr, highlights: { comparing: [i] }, message: `Memeriksa indeks ${i} (nilai: ${arr[i]})` };
            if (arr[i] === value) {
                yield { arr, highlights: { found: i }, message: `Angka ${value} ditemukan di indeks ${i}!` }; return;
            }
        }
        yield { arr, highlights: {}, message: `Angka ${value} tidak ditemukan.` };
    }

    function* binarySearchGenerator(arr, { value }) {
        if (isNaN(value)) {
            yield { message: "Masukkan angka yang valid!" }; return;
        }
        let low = 0, high = arr.length - 1;
        while (low <= high) {
            const mid = Math.floor((low + high) / 2);
            yield { arr, highlights: { pivot: mid, comparing: [low, high] }, message: `Memeriksa tengah (indeks ${mid})` };
            if (arr[mid] === value) {
                yield { arr, highlights: { found: mid }, message: `Angka ${value} ditemukan di indeks ${mid}!` }; return;
            } else if (arr[mid] < value) {
                yield { arr, highlights: { pivot: mid, comparing: [low, high] }, message: `Nilai terlalu kecil, cari di kanan.` };
                low = mid + 1;
            } else {
                yield { arr, highlights: { pivot: mid, comparing: [low, high] }, message: `Nilai terlalu besar, cari di kiri.` };
                high = mid - 1;
            }
        }
        yield { arr, highlights: {}, message: `Angka ${value} tidak ditemukan.` };
    }
    
    function* bubbleSortGenerator(arr) {
        const n = arr.length;
        for (let i = 0; i < n - 1; i++) {
            let swapped = false;
            for (let j = 0; j < n - i - 1; j++) {
                yield { arr, highlights: { comparing: [j, j + 1], sorted: Array.from({length: i}, (_, k) => n - 1 - k) }, message: `Membandingkan ${arr[j]} dan ${arr[j+1]}` };
                if (arr[j] > arr[j + 1]) {
                    swapped = true;
                    [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                    yield { arr, highlights: { comparing: [j, j + 1], sorted: Array.from({length: i}, (_, k) => n - 1 - k) }, message: `Menukar posisi` };
                }
            }
            if (!swapped) break;
        }
        yield { arr, highlights: { sorted: Array.from(Array(n).keys()) }, message: `Pengurutan Selesai!` };
    }

    function* selectionSortGenerator(arr) {
        const n = arr.length;
        for (let i = 0; i < n - 1; i++) {
            let minIndex = i;
            yield { arr, highlights: { pivot: i, sorted: Array.from(Array(i).keys()) }, message: `Iterasi ${i+1}: Mencari minimum` };
            for (let j = i + 1; j < n; j++) {
                yield { arr, highlights: { pivot: minIndex, comparing: [j], sorted: Array.from(Array(i).keys()) }, message: `Membandingkan min (${arr[minIndex]}) dengan ${arr[j]}` };
                if (arr[j] < arr[minIndex]) {
                    minIndex = j;
                    yield { arr, highlights: { pivot: minIndex, sorted: Array.from(Array(i).keys()) }, message: `Minimum baru ditemukan: ${arr[minIndex]}` };
                }
            }
            if (minIndex !== i) {
                [arr[i], arr[minIndex]] = [arr[minIndex], arr[i]];
                yield { arr, highlights: { comparing: [i, minIndex], sorted: Array.from(Array(i).keys()) }, message: `Menukar ${arr[minIndex]} dengan ${arr[i]}` };
            }
        }
        yield { arr, highlights: { sorted: Array.from(Array(n).keys()) }, message: `Pengurutan Selesai!` };
    }

    setupSimulator({
        id: 'linear-search',
        generatorFn: linearSearchGenerator,
        createArrayFn: () => createRandomArray(15, 99),
        getParamsFn: () => ({ value: parseInt(document.getElementById('linear-search-value').value) })
    });

    setupSimulator({
        id: 'binary-search',
        generatorFn: binarySearchGenerator,
        createArrayFn: () => createRandomArray(15, 99, true),
        getParamsFn: () => ({ value: parseInt(document.getElementById('binary-search-value').value) })
    });
    
    setupSimulator({
        id: 'bubble-sort',
        generatorFn: bubbleSortGenerator,
        createArrayFn: () => createRandomArray(20, 100)
    });

    setupSimulator({
        id: 'selection-sort',
        generatorFn: selectionSortGenerator,
        createArrayFn: () => createRandomArray(20, 100)
    });

    const worksheetScoreEl = document.getElementById('worksheet-score');
    const checkAnswerBtns = document.querySelectorAll('.check-answer-btn');
    const answeredQuestions = new Set();
    let score = 0;

    const updateScore = () => {
        score = answeredQuestions.size;
        worksheetScoreEl.textContent = `${score} / 3`;
    };

    checkAnswerBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const questionId = btn.dataset.question;
            const questionDiv = document.querySelector(`[data-question="${questionId}"]`);
            const feedbackEl = questionDiv.querySelector('.feedback-text');
            let isCorrect = false;

            if (questionId === '1') {
                const selected = questionDiv.querySelector('input[name="q1"]:checked');
                isCorrect = selected && selected.value === btn.dataset.correct;
            } 
            else if (questionId === '2') {
                const dropZone = document.getElementById('drop-zone-selection-sort');
                const droppedItems = Array.from(dropZone.children);
                const currentOrder = droppedItems.map(item => item.dataset.step).join('');
                isCorrect = currentOrder === '1234';

                // ** DIPERBAIKI: Kembalikan item jika salah **
                if (!isCorrect) {
                    const dragItemsContainer = document.getElementById('drag-items-container');
                    droppedItems.forEach(item => dragItemsContainer.appendChild(item));
                }
            }
            else if (questionId === '3') {
                const input = document.getElementById('q3-input').value.replace(/\s/g, '');
                isCorrect = input === btn.dataset.correct;
            }

            if (isCorrect) {
                feedbackEl.textContent = "Benar!";
                feedbackEl.className = 'feedback-text ml-4 font-semibold feedback-correct';
                if (!answeredQuestions.has(questionId)) {
                    answeredQuestions.add(questionId);
                    updateScore();
                }
            } else {
                feedbackEl.textContent = "Salah, coba lagi.";
                feedbackEl.className = 'feedback-text ml-4 font-semibold feedback-incorrect';
            }
        });
    });

    const dragItems = document.querySelectorAll('.drag-item');
    const dropZone = document.getElementById('drop-zone-selection-sort');

    dragItems.forEach(item => {
        item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.step);
            e.target.style.opacity = '0.5';
        });
        item.addEventListener('dragend', (e) => {
            e.target.style.opacity = '1';
        });
    });

    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('drag-over');
    });

    dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('drag-over');
    });

    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.classList.remove('drag-over');
        const step = e.dataTransfer.getData('text/plain');
        const draggedItem = document.querySelector(`.drag-item[data-step="${step}"]`);
        if (draggedItem && !dropZone.contains(draggedItem)) {
            dropZone.appendChild(draggedItem);
        }
    });
});
</script>
</body>
</html>
