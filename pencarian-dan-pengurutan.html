<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Algoritma & Lembar Kerja</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://css-proxy.vercel.app/api/fonts/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-btn.active { background-color: #0ea5e9; color: white; }
        .array-bar { transition: all 0.3s ease-in-out; }
        /* Style untuk Lembar Kerja Kuis */
        .quiz-feedback {
            font-weight: 600;
            margin-left: 1rem;
        }
        .quiz-feedback.correct {
            color: #4ade80;
        }
        .quiz-feedback.incorrect {
            color: #f87171;
        }
        .quiz-input {
            background-color: #334155;
            border-bottom: 2px solid #64748b;
        }
        .quiz-input:focus {
            outline: none;
            border-bottom-color: #38bdf8;
        }
        .quiz-input.correct {
            border-bottom-color: #22c55e;
        }
        .quiz-input.incorrect {
            border-bottom-color: #ef4444;
        }
        .correct-answer-text {
            color: #4ade80;
            font-size: 0.9em;
            font-style: italic;
        }
    </style>
</head>
<body class="bg-slate-900 text-white">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-sky-400 to-cyan-300 text-transparent bg-clip-text">Simulasi & Lembar Kerja Algoritma</h1>
            <p class="text-slate-400 mt-2">Belajar, simulasi, dan uji pemahaman Anda di satu tempat.</p>
        </header>

        <!-- Tab Buttons -->
        <div class="flex border-b border-slate-700 mb-6">
            <button class="tab-btn flex-1 py-3 px-4 font-semibold text-slate-300 hover:bg-slate-700 transition-colors active" data-target="pencarian">Algoritma Pencarian</button>
            <button class="tab-btn flex-1 py-3 px-4 font-semibold text-slate-300 hover:bg-slate-700 transition-colors" data-target="pengurutan">Algoritma Pengurutan</button>
            <button class="tab-btn flex-1 py-3 px-4 font-semibold text-slate-300 hover:bg-slate-700 transition-colors" data-target="worksheet">Lembar Kerja Interaktif</button>
        </div>

        <!-- Konten Tab -->
        <main>
            <div id="pencarian" class="tab-content active">
                <div class="space-y-8">
                    <!-- Linear Search -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">1. Linear Search (Pencarian Linier)</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma paling dasar. Ia memeriksa setiap elemen dalam array satu per satu dari awal hingga akhir sampai elemen yang dicari ditemukan atau sampai seluruh array selesai diperiksa.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(1) - Elemen ditemukan di posisi pertama.</li>
                                    <li><strong>Average Case:</strong> O(n) - Elemen ditemukan di tengah.</li>
                                    <li><strong>Worst Case:</strong> O(n) - Elemen ditemukan di akhir atau tidak ada.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <input type="number" id="linear-search-value" class="bg-slate-700 p-2 rounded-md border border-slate-600 w-full sm:w-auto" placeholder="Cari angka...">
                                    <button id="linear-search-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Jalankan Otomatis</button>
                                    <button id="linear-search-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Langkah Berikutnya</button>
                                    <button id="linear-search-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Reset</button>
                                </div>
                                <div id="linear-search-container" class="flex justify-center items-end gap-1 h-32 bg-slate-950 p-2 rounded-md"></div>
                                <div id="linear-search-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Binary Search -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">2. Binary Search (Pencarian Biner)</h2>
                         <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma yang sangat efisien, namun **membutuhkan array yang sudah terurut**. Ia bekerja dengan membandingkan elemen target dengan elemen tengah array. Jika tidak sama, setengah bagian array yang tidak mungkin mengandung target akan diabaikan, dan pencarian dilanjutkan pada setengah sisanya. Proses ini diulangi hingga elemen ditemukan.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(1) - Elemen ditemukan di tengah pada percobaan pertama.</li>
                                    <li><strong>Average Case:</strong> O(log n) - Sangat cepat.</li>
                                    <li><strong>Worst Case:</strong> O(log n) - Sangat cepat.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <input type="number" id="binary-search-value" class="bg-slate-700 p-2 rounded-md border border-slate-600 w-full sm:w-auto" placeholder="Cari angka...">
                                    <button id="binary-search-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Jalankan Otomatis</button>
                                    <button id="binary-search-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Langkah Berikutnya</button>
                                    <button id="binary-search-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg w-full sm:w-auto">Reset</button>
                                </div>
                                <div id="binary-search-container" class="flex justify-center items-end gap-1 h-32 bg-slate-950 p-2 rounded-md"></div>
                                <div id="binary-search-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
            
            <div id="pengurutan" class="tab-content">
                 <div class="space-y-8">
                     <!-- Bubble Sort -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">1. Bubble Sort</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma ini berulang kali melewati daftar, membandingkan pasangan elemen yang berdekatan, dan menukarnya jika urutannya salah. Elemen terbesar akan "menggelembung" (bubble) ke posisi akhir pada setiap iterasi. Proses ini diulangi sampai tidak ada lagi pertukaran yang diperlukan.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(n) - Jika array sudah terurut.</li>
                                    <li><strong>Average Case:</strong> O(n²) - Cukup lambat.</li>
                                    <li><strong>Worst Case:</strong> O(n²) - Sangat lambat jika array terbalik.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4 flex-wrap">
                                    <button id="bubble-sort-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg">Otomatis</button>
                                    <button id="bubble-sort-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg">Per Langkah</button>
                                    <button id="bubble-sort-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg">Reset Acak</button>
                                    <label for="speed-slider-bubble-sort" class="text-sm">Kecepatan:</label>
                                    <input type="range" id="speed-slider-bubble-sort" min="50" max="500" value="200" class="flex-grow">
                                </div>
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <input type="text" id="bubble-sort-custom-data" class="bg-slate-700 p-2 rounded-md border border-slate-600 flex-grow" placeholder="Contoh: 5, 1, 9, 3, 7">
                                    <button id="bubble-sort-use-custom" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg whitespace-nowrap">Gunakan Data Sendiri</button>
                                </div>
                                <div id="bubble-sort-container" class="flex justify-center items-end gap-1 h-64 bg-slate-950 p-2 rounded-md"></div>
                                <div id="bubble-sort-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Selection Sort -->
                    <section class="bg-slate-800 p-6 rounded-xl">
                        <h2 class="text-2xl font-bold text-cyan-300 mb-4">2. Selection Sort</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Cara Kerja</h3>
                                <p class="text-slate-400 mb-4 text-sm leading-relaxed">Algoritma ini membagi array menjadi dua bagian: bagian terurut dan bagian tidak terurut. Ia kemudian berulang kali mencari elemen terkecil dari bagian yang tidak terurut dan memindahkannya ke akhir bagian yang terurut. Proses ini diulangi hingga seluruh array terurut.</p>
                                <h3 class="text-lg font-semibold text-sky-400 mb-2">Kompleksitas Waktu</h3>
                                <ul class="text-sm list-disc list-inside text-slate-400 space-y-1">
                                    <li><strong>Best Case:</strong> O(n²)</li>
                                    <li><strong>Average Case:</strong> O(n²)</li>
                                    <li><strong>Worst Case:</strong> O(n²) - Performanya konsisten lambat.</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900 p-4 rounded-lg">
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4 flex-wrap">
                                    <button id="selection-sort-play" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg">Otomatis</button>
                                    <button id="selection-sort-step" class="bg-sky-800 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg">Per Langkah</button>
                                    <button id="selection-sort-reset" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg">Reset Acak</button>
                                    <label for="speed-slider-selection-sort" class="text-sm">Kecepatan:</label>
                                    <input type="range" id="speed-slider-selection-sort" min="50" max="500" value="200" class="flex-grow">
                                </div>
                                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                                    <input type="text" id="selection-sort-custom-data" class="bg-slate-700 p-2 rounded-md border border-slate-600 flex-grow" placeholder="Contoh: 25, 8, 45, 12">
                                    <button id="selection-sort-use-custom" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg whitespace-nowrap">Gunakan Data Sendiri</button>
                                </div>
                                <div id="selection-sort-container" class="flex justify-center items-end gap-1 h-64 bg-slate-950 p-2 rounded-md"></div>
                                <div id="selection-sort-log" class="mt-4 text-sm text-slate-300 h-6 text-center font-mono"></div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="worksheet" class="tab-content">
                <div class="bg-slate-800 p-6 rounded-xl">
                    <div class="text-center border-b border-slate-700 pb-6 mb-6">
                        <h2 class="text-2xl font-bold text-cyan-300">Kuis Pasca-Kegiatan: Memahami Algoritma Pengurutan</h2>
                        <p class="text-slate-400 mt-1">Jawablah berdasarkan simulasi "Bermain Kartu" yang telah dilakukan.</p>
                    </div>

                    <div id="quiz-container" class="space-y-8">
                        <div class="bg-slate-900 p-4 rounded-lg">
                            <div class="flex flex-col sm:flex-row gap-4 sm:items-center">
                                <div><label for="quiz-student-name" class="block text-sm font-medium mb-1">Nama Siswa:</label><input type="text" id="quiz-student-name" class="quiz-input px-2 py-1 w-64"></div>
                                <div><label for="quiz-student-class" class="block text-sm font-medium mb-1">Kelas:</label><input type="text" id="quiz-student-class" class="quiz-input px-2 py-1 w-32"></div>
                            </div>
                        </div>

                        <!-- Bagian A -->
                        <div class="bg-slate-900 p-6 rounded-lg">
                            <div class="flex justify-between items-center">
                                <h3 class="font-bold text-lg text-sky-400">Bagian A: Identifikasi Konsep</h3>
                                <span class="text-sm text-slate-400">(Total Poin: 20)</span>
                            </div>
                            <hr class="border-slate-700 my-4">
                            <div class="space-y-6">
                                <div data-quiz-question="A1">
                                    <p class="mb-2">1. Algoritma yang cara kerjanya membandingkan dan menukar sebuah elemen data dengan elemen tepat di sebelahnya secara berulang-ulang hingga seluruh data terurut disebut... <span class="quiz-feedback"></span></p>
                                    <div class="space-y-2 text-slate-300">
                                        <label class="flex items-center"><input type="radio" name="qA1" value="a" class="mr-3"> a. Selection Sort</label>
                                        <label class="flex items-center"><input type="radio" name="qA1" value="b" class="mr-3" data-correct> b. Bubble Sort</label>
                                        <label class="flex items-center"><input type="radio" name="qA1" value="c" class="mr-3"> c. Random Sort</label>
                                        <label class="flex items-center"><input type="radio" name="qA1" value="d" class="mr-3"> d. Quick Sort</label>
                                    </div>
                                </div>
                                <div data-quiz-question="A2">
                                    <p class="mb-2">2. Algoritma yang cara kerjanya mencari elemen terkecil dari sisa data yang belum terurut, lalu menukarkannya ke posisi paling awal (yang belum terisi) disebut... <span class="quiz-feedback"></span></p>
                                    <div class="space-y-2 text-slate-300">
                                        <label class="flex items-center"><input type="radio" name="qA2" value="a" class="mr-3" data-correct> a. Selection Sort</label>
                                        <label class="flex items-center"><input type="radio" name="qA2" value="b" class="mr-3"> b. Bubble Sort</label>
                                        <label class="flex items-center"><input type="radio" name="qA2" value="c" class="mr-3"> c. Neighbor Sort</label>
                                        <label class="flex items-center"><input type="radio" name="qA2" value="d" class="mr-3"> d. Search Sort</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bagian B -->
                        <div class="bg-slate-900 p-6 rounded-lg">
                            <h3 class="font-bold text-lg text-sky-400">Bagian B: Analisis Proses</h3>
                            <div class="space-y-6 mt-4">
                                <div>
                                    <p class="mb-2">3. Jelaskan dengan bahasamu sendiri, apa perbedaan utama cara kerja antara Bubble Sort dan Selection Sort?</p>
                                    <textarea class="w-full bg-slate-700 p-2 rounded-md border border-slate-600 min-h-[80px]"></textarea>
                                </div>
                                <div>
                                    <p class="mb-2">4. Mengapa jumlah "langkah" atau "pertukaran posisi" antara kedua metode tersebut bisa berbeda? Metode mana yang cenderung melakukan lebih banyak pertukaran?</p>
                                    <textarea class="w-full bg-slate-700 p-2 rounded-md border border-slate-600 min-h-[80px]"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Bagian C -->
                        <div class="bg-slate-900 p-6 rounded-lg">
                            <h3 class="font-bold text-lg text-sky-400">Bagian C: Studi Kasus Sederhana</h3>
                             <p class="text-sm text-slate-400 mt-1 mb-4">Bayangkan ada 5 siswa yang memegang kartu angka sebagai berikut: `[ 8, 5, 9, 2, 6 ]`</p>
                            <div class="space-y-6">
                                <div data-quiz-question="C1">
                                    <p class="mb-2">5. Jika kita menggunakan metode **Bubble Sort**, bagaimana susunan angka tersebut setelah **satu putaran/iterasi pertama** selesai? <span class="quiz-feedback"></span></p>
                                    <p>Jawaban: [ <input type="text" id="qC1" data-correct="5,8,2,6,9" class="quiz-input w-48 px-2 py-1"> ] <span class="correct-answer-text"></span></p>
                                </div>
                                <div data-quiz-question="C2">
                                    <p class="mb-2">6. Jika kita menggunakan metode **Selection Sort** pada deret angka yang sama, bagaimana susunan angka tersebut setelah **satu putaran/iterasi pertama** selesai? <span class="quiz-feedback"></span></p>
                                    <p>Jawaban: [ <input type="text" id="qC2" data-correct="2,5,9,8,6" class="quiz-input w-48 px-2 py-1"> ] <span class="correct-answer-text"></span></p>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="mt-8 pt-6 border-t border-slate-700 flex justify-center items-center gap-6">
                        <button id="check-quiz-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg">Periksa Jawaban Saya</button>
                        <button id="reset-quiz-btn" class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-3 px-6 rounded-lg">Ulangi</button>
                        <div class="text-lg font-bold">Total Skor Otomatis: <span id="quiz-score" class="text-sky-400">0 / 60</span></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            tabContents.forEach(content => content.classList.remove('active'));
            document.getElementById(button.dataset.target).classList.add('active');
        });
    });

    const createRandomArray = (size, maxVal, sorted = false) => {
        const arr = Array.from({ length: size }, () => Math.floor(Math.random() * maxVal) + 1);
        if (sorted) arr.sort((a, b) => a - b);
        return arr;
    };

    const renderArray = (container, arr, highlights = {}) => {
        if (!container) return;
        container.innerHTML = arr.map((value, index) => {
            let bgColor = 'bg-slate-600';
            if (highlights.found === index) bgColor = 'bg-green-500';
            else if (highlights.comparing?.includes(index)) bgColor = 'bg-yellow-500';
            else if (highlights.pivot === index) bgColor = 'bg-purple-500';
            else if (highlights.sorted?.includes(index)) bgColor = 'bg-sky-500';
            const height = container.id.includes('sort') ? `${(value / 100) * 90 + 10}%` : '50%';
            return `<div class="array-bar flex-1 ${bgColor} text-center font-semibold pt-1 rounded-t-md" style="height: ${height};">${value}</div>`;
        }).join('');
    };

    function* linearSearchGenerator(arr, { value }) {
        if (isNaN(value)) {
            yield { message: "Masukkan angka yang valid!" }; return;
        }
        for (let i = 0; i < arr.length; i++) {
            yield { arr, highlights: { comparing: [i] }, message: `Memeriksa indeks ${i} (nilai: ${arr[i]})` };
            if (arr[i] === value) {
                yield { arr, highlights: { found: i }, message: `Angka ${value} ditemukan di indeks ${i}!` }; return;
            }
        }
        yield { arr, highlights: {}, message: `Angka ${value} tidak ditemukan.` };
    }

    function* binarySearchGenerator(arr, { value }) {
        if (isNaN(value)) {
            yield { message: "Masukkan angka yang valid!" }; return;
        }
        let low = 0, high = arr.length - 1;
        while (low <= high) {
            const mid = Math.floor((low + high) / 2);
            yield { arr, highlights: { pivot: mid, comparing: [low, high] }, message: `Memeriksa tengah (indeks ${mid})` };
            if (arr[mid] === value) {
                yield { arr, highlights: { found: mid }, message: `Angka ${value} ditemukan di indeks ${mid}!` }; return;
            } else if (arr[mid] < value) {
                yield { arr, highlights: { pivot: mid, comparing: [low, high] }, message: `Nilai terlalu kecil, cari di kanan.` };
                low = mid + 1;
            } else {
                yield { arr, highlights: { pivot: mid, comparing: [low, high] }, message: `Nilai terlalu besar, cari di kiri.` };
                high = mid - 1;
            }
        }
        yield { arr, highlights: {}, message: `Angka ${value} tidak ditemukan.` };
    }
    
    function* bubbleSortGenerator(arr) {
        const n = arr.length;
        for (let i = 0; i < n - 1; i++) {
            let swapped = false;
            for (let j = 0; j < n - i - 1; j++) {
                yield { arr, highlights: { comparing: [j, j + 1], sorted: Array.from({length: i}, (_, k) => n - 1 - k) }, message: `Membandingkan ${arr[j]} dan ${arr[j+1]}` };
                if (arr[j] > arr[j + 1]) {
                    swapped = true;
                    [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                    yield { arr, highlights: { comparing: [j, j + 1], sorted: Array.from({length: i}, (_, k) => n - 1 - k) }, message: `Menukar posisi` };
                }
            }
            if (!swapped) break;
        }
        yield { arr, highlights: { sorted: Array.from(Array(n).keys()) }, message: `Pengurutan Selesai!` };
    }

    function* selectionSortGenerator(arr) {
        const n = arr.length;
        for (let i = 0; i < n - 1; i++) {
            let minIndex = i;
            yield { arr, highlights: { pivot: i, sorted: Array.from(Array(i).keys()) }, message: `Iterasi ${i+1}: Mencari minimum` };
            for (let j = i + 1; j < n; j++) {
                yield { arr, highlights: { pivot: minIndex, comparing: [j], sorted: Array.from(Array(i).keys()) }, message: `Membandingkan min (${arr[minIndex]}) dengan ${arr[j]}` };
                if (arr[j] < arr[minIndex]) {
                    minIndex = j;
                    yield { arr, highlights: { pivot: minIndex, sorted: Array.from(Array(i).keys()) }, message: `Minimum baru ditemukan: ${arr[minIndex]}` };
                }
            }
            if (minIndex !== i) {
                [arr[i], arr[minIndex]] = [arr[minIndex], arr[i]];
                yield { arr, highlights: { comparing: [i, minIndex], sorted: Array.from(Array(i).keys()) }, message: `Menukar ${arr[minIndex]} dengan ${arr[i]}` };
            }
        }
        yield { arr, highlights: { sorted: Array.from(Array(n).keys()) }, message: `Pengurutan Selesai!` };
    }
    
    function setupSimulator(config) {
        const { id, generatorFn, createArrayFn, getParamsFn } = config;
        const container = document.getElementById(`${id}-container`);
        const log = document.getElementById(`${id}-log`);
        const playBtn = document.getElementById(`${id}-play`);
        const stepBtn = document.getElementById(`${id}-step`);
        const resetBtn = document.getElementById(`${id}-reset`);
        const speedSlider = document.getElementById(`speed-slider-${id}`);
        const customDataInput = document.getElementById(`${id}-custom-data`);
        const useCustomDataBtn = document.getElementById(`${id}-use-custom`);

        let array = [];
        let generator = null;
        let isPlaying = false;
        let simSpeed = speedSlider ? 600 - parseInt(speedSlider.value) : 200;

        const setControlsDisabled = (disabled, keepPlayDisabled = false) => {
            if (playBtn) playBtn.disabled = keepPlayDisabled || disabled;
            if (stepBtn) stepBtn.disabled = disabled;
        };
        
        const reset = (customArray = null) => {
            isPlaying = false;
            array = customArray || createArrayFn();
             if (array.length > 50) array = array.slice(0, 50);
            
            if (!getParamsFn) {
                generator = generatorFn(array.slice());
            } else {
                 generator = null;
            }
            renderArray(container, array);
            log.textContent = "Siap untuk memulai.";
            setControlsDisabled(false);
        };
        
        const step = () => {
            if (getParamsFn && (!generator || !isPlaying)) {
                generator = generatorFn(array.slice(), getParamsFn());
                isPlaying = true;
            }
            if (!generator) return;

            const result = generator.next();
            if (result.value) {
                const { arr, highlights, message } = result.value;
                if(arr) array = arr;
                renderArray(container, array, highlights);
                log.textContent = message;
            }
            if (result.done) {
                isPlaying = false;
                setControlsDisabled(true);
            } else {
                setControlsDisabled(true, true);
                stepBtn.disabled = false;
            }
        };

        const play = async () => {
            if (isPlaying) return;
            if (getParamsFn) {
                generator = generatorFn(array.slice(), getParamsFn());
            }
            if (!generator) return;

            isPlaying = true;
            setControlsDisabled(true);

            let result = {};
            while (!result.done) {
                result = generator.next();
                if (result.value) {
                    const { arr, highlights, message } = result.value;
                    if(arr) array = arr;
                    renderArray(container, array, highlights);
                    log.textContent = message;
                }
                if (result.done) break;
                await new Promise(resolve => setTimeout(resolve, simSpeed));
            }
            isPlaying = false;
        };

        if (playBtn) playBtn.addEventListener('click', play);
        if (stepBtn) stepBtn.addEventListener('click', step);
        if (resetBtn) resetBtn.addEventListener('click', () => reset());
        
        if (useCustomDataBtn) {
            useCustomDataBtn.addEventListener('click', () => {
                const text = customDataInput.value;
                const customArray = text.split(',')
                    .map(s => parseInt(s.trim()))
                    .filter(n => !isNaN(n) && n > 0 && n <= 100);
                
                if (customArray.length > 0) {
                    reset(customArray);
                } else {
                    log.textContent = "Masukkan data angka yang valid (1-100), pisahkan dengan koma.";
                }
            });
        }
        
        if (speedSlider) {
            speedSlider.addEventListener('input', (e) => {
                simSpeed = 600 - parseInt(e.target.value);
            });
        }
        
        reset();
    }

    setupSimulator({
        id: 'linear-search',
        generatorFn: linearSearchGenerator,
        createArrayFn: () => createRandomArray(15, 99),
        getParamsFn: () => ({ value: parseInt(document.getElementById('linear-search-value').value) })
    });

    setupSimulator({
        id: 'binary-search',
        generatorFn: binarySearchGenerator,
        createArrayFn: () => createRandomArray(15, 99, true),
        getParamsFn: () => ({ value: parseInt(document.getElementById('binary-search-value').value) })
    });
    
    setupSimulator({
        id: 'bubble-sort',
        generatorFn: bubbleSortGenerator,
        createArrayFn: () => createRandomArray(20, 100)
    });

    setupSimulator({
        id: 'selection-sort',
        generatorFn: selectionSortGenerator,
        createArrayFn: () => createRandomArray(20, 100)
    });

    const checkQuizBtn = document.getElementById('check-quiz-btn');
    const resetQuizBtn = document.getElementById('reset-quiz-btn');
    const quizContainer = document.getElementById('quiz-container');
    const scoreEl = document.getElementById('quiz-score');

    const checkQuizAnswers = () => {
        let currentScore = 0;
        const totalPoints = 60;

        // Cek Bagian A
        const qA1 = quizContainer.querySelector('input[name="qA1"]:checked');
        const feedbackA1 = quizContainer.querySelector('[data-quiz-question="A1"] .quiz-feedback');
        if (qA1 && qA1.hasAttribute('data-correct')) {
            currentScore += 10;
            feedbackA1.textContent = "Benar (+10)";
            feedbackA1.className = 'quiz-feedback correct';
        } else {
            feedbackA1.textContent = "Salah";
            feedbackA1.className = 'quiz-feedback incorrect';
        }

        const qA2 = quizContainer.querySelector('input[name="qA2"]:checked');
        const feedbackA2 = quizContainer.querySelector('[data-quiz-question="A2"] .quiz-feedback');
        if (qA2 && qA2.hasAttribute('data-correct')) {
            currentScore += 10;
            feedbackA2.textContent = "Benar (+10)";
            feedbackA2.className = 'quiz-feedback correct';
        } else {
            feedbackA2.textContent = "Salah";
            feedbackA2.className = 'quiz-feedback incorrect';
        }

        // Cek Bagian C
        const qC1Input = document.getElementById('qC1');
        const feedbackC1 = quizContainer.querySelector('[data-quiz-question="C1"] .quiz-feedback');
        const correctAnsC1Text = quizContainer.querySelector('[data-quiz-question="C1"] .correct-answer-text');
        const userAnswerC1 = qC1Input.value.replace(/\s/g, '');
        const correctAnswerC1 = qC1Input.dataset.correct.replace(/\s/g, '');
        if (userAnswerC1 === correctAnswerC1) {
            currentScore += 20;
            qC1Input.className = 'quiz-input w-48 px-2 py-1 correct';
            feedbackC1.textContent = "Benar (+20)";
            feedbackC1.className = 'quiz-feedback correct';
            correctAnsC1Text.textContent = '';
        } else {
            qC1Input.className = 'quiz-input w-48 px-2 py-1 incorrect';
            feedbackC1.textContent = "Salah";
            feedbackC1.className = 'quiz-feedback incorrect';
            correctAnsC1Text.textContent = `Jawaban: [ ${qC1Input.dataset.correct} ]`;
        }
        
        const qC2Input = document.getElementById('qC2');
        const feedbackC2 = quizContainer.querySelector('[data-quiz-question="C2"] .quiz-feedback');
        const correctAnsC2Text = quizContainer.querySelector('[data-quiz-question="C2"] .correct-answer-text');
        const userAnswerC2 = qC2Input.value.replace(/\s/g, '');
        const correctAnswerC2 = qC2Input.dataset.correct.replace(/\s/g, '');
        if (userAnswerC2 === correctAnswerC2) {
            currentScore += 20;
            qC2Input.className = 'quiz-input w-48 px-2 py-1 correct';
            feedbackC2.textContent = "Benar (+20)";
            feedbackC2.className = 'quiz-feedback correct';
            correctAnsC2Text.textContent = '';
        } else {
            qC2Input.className = 'quiz-input w-48 px-2 py-1 incorrect';
            feedbackC2.textContent = "Salah";
            feedbackC2.className = 'quiz-feedback incorrect';
            correctAnsC2Text.textContent = `Jawaban: [ ${qC2Input.dataset.correct} ]`;
        }

        scoreEl.textContent = `${currentScore} / ${totalPoints}`;
    };

    const resetQuiz = () => {
        quizContainer.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
        quizContainer.querySelectorAll('input[type="text"], textarea').forEach(input => input.value = '');
        quizContainer.querySelectorAll('.quiz-feedback, .correct-answer-text').forEach(el => el.textContent = '');
        quizContainer.querySelectorAll('.quiz-input').forEach(el => {
             el.className = 'quiz-input px-2 py-1';
             if (el.id === 'qC1' || el.id === 'qC2') el.classList.add('w-48');
             else if (el.id === 'quiz-student-name') el.classList.add('w-64');
             else if (el.id === 'quiz-student-class') el.classList.add('w-32');
        });
        scoreEl.textContent = `0 / 60`;
    };

    checkQuizBtn.addEventListener('click', checkQuizAnswers);
    resetQuizBtn.addEventListener('click', resetQuiz);
});
</script>
</body>
</html>
